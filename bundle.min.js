"use strict";var $notepad=$("#notepad"),menubar=new Menubar,editor=new Editor,$editor=editor.init();$notepad.append($editor);var dlgFont=new DlgFont(editor),$dlgFont=dlgFont.init();$notepad.after($dlgFont),$notepad.click(menubar.hideMenu.bind(menubar));var menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("新建(N) menu clicked!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("打开(O) menu clicked!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("保存(S) menu clicked!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("另存为(A) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("页面设置(U) menu clicked!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("打印(P) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("退出(X) menu clicked!")}}],width:"202px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("撤销(U) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("剪切(X) menu clicked!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("复制(C) menu clicked!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("粘贴(P) menu clicked!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("删除(L) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("使用 Bing 搜索 menu clicked!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("查找(F) menu clicked!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("查找下一个(N) menu clicked!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("替换(R) menu clicked!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){console.log("转到(G) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("全选(A) menu clicked!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("时间/日期(D) menu clicked!")}}],width:"218px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("自动换行(W) menu clicked!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:dlgFont.open.bind(dlgFont)}],width:"156px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("状态栏(S) menu clicked!")}}],width:"138px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){console.log("查看帮助(H) menu clicked!")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){console.log("关于记事本(A) menu clicked!")}}],width:"166px"}],$menubar=menubar.init(menuData);function DlgFont(e){this.editor=e,this.$textarea=e.$textarea,this.$dlg_font=null,this.$select_box_inputs=[],this.$select_box_item_lis=[[],[],[]],this.$sample_p=$("<p>AaBbYyZz</p>"),this.nowSelect=[0,0,0],this.newSelect=[0,0,0],this.fonts=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],this.styles=["常规","斜体","粗体","粗偏斜体"],this.sizes=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],this.init=function(){var e=[{title:"字体(F):",ul:this.fonts,default:2},{title:"字形(Y):",ul:this.styles,default:0},{title:"大小(S):",ul:this.sizes,default:6}],s=$('<div class="dlg_font"></div>'),i=$('<div class="dlg_font_box"></div>'),t=$('<div class="header"></div>'),n=$("<div>字体</div>"),l=$("<div>X</div>");l.click(this.close.bind(this)),t.append(n),t.append(l),t.mousedown(function(t){var n=i.position().top,l=i.position().left;0==t.button&&(s.mousemove(function(e){i.css("left",e.pageX-t.pageX+l+"px"),i.css("top",e.pageY-t.pageY+n+"px")}),s.mouseup(function(){s.off("mousemove"),s.off("mouseup")}))}),i.append(t);for(var o=$('<div class="body"></div>'),c=$('<div class="select_box"></div>'),a=0;a<e.length;a++){for(var d=$("<span>"+e[a].title+"</span>"),h=$('<input type="text">'),u=$("<ul></ul>"),r=0;r<e[a].ul.length;r++){var p=$("<li>"+e[a].ul[r]+"</li>");0==a?p.css("font-family",e[a].ul[r]):1==a&&this.changeStyle(p,r),p.click(this.selectLi.bind(this,a,r)),this.$select_box_item_lis[a].push(p),u.append(p)}this.$select_box_inputs.push(h),this.selectLi(a,e[a].default),c.append(d),c.append(h),c.append(u)}this.selectSave();var f=$('<fieldset class="sample"></fieldset>');f.append($("<legend>示例</legend>"));var m=this.$sample_p;f.append(m);var b=$('<div class="script"></div>');b.append($("<span>脚本(R):</span><br>"));var g=$("<select></select>");g.append($('<option value="西欧语言">西欧语言</option>')),g.append($('<option value="中文 GB2312">中文 GB2312</option>')),b.append(g);var v=$('<input type="button" value="确定" class="btn_ok">'),_=$('<input type="button" value="取消" class="btn_cancel">');return v.click(function(){this.selectSave(),this.close()}.bind(this)),_.click(this.close.bind(this)),o.append(c),o.append(f),o.append(b),o.append(v),o.append(_),i.append(o),s.append(i),this.$dlg_font=s},this.selectLi=function(e,t){for(var n=0;n<this.$select_box_item_lis[e].length;n++)n==t?this.$select_box_item_lis[e][n].addClass("selected"):this.$select_box_item_lis[e][n].removeClass("selected");this.newSelect[e]=t,0==e?(this.$select_box_inputs[e].val(this.fonts[t]),this.$sample_p.css("font-family",this.fonts[t])):1==e?(this.$select_box_inputs[e].val(this.styles[t]),this.changeStyle(this.$sample_p,t)):2==e&&(this.$select_box_inputs[e].val(this.sizes[t]),this.$sample_p.css("font-size",this.sizes[t]+"px"))},this.changeStyle=function(e,t){0==t?(e.css("font-style","normal"),e.css("font-weight","normal")):1==t?(e.css("font-style","italic"),e.css("font-weight","normal")):2==t?(e.css("font-style","normal"),e.css("font-weight","bold")):3==t&&(e.css("font-style","italic"),e.css("font-weight","bold"))},this.selectSave=function(){var e=this.newSelect;this.nowSelect=e,this.$textarea.css("font-family",this.fonts[e[0]]),this.changeStyle(this.$textarea,e[1]),this.$textarea.css("font-size",this.sizes[e[2]]+"px")},this.close=function(){this.$dlg_font.removeClass("show")},this.open=function(){this.$dlg_font.addClass("show")}}function Editor(){this.$editor=$('<div class="editor"></div>'),this.$textarea=$('<textarea spellcheck="false" auto-size="none" wrap="off"></textarea>'),this.init=function(){return this.$editor.append(this.$textarea),this.$editor}}function Menubar(){this.$menubar=null,this.$menus=[],this.openMenu=-1,this.init=function(e){for(var t=$('<div class="menubar"></div>'),n=$('<ul class="menu_title">'),l=0;l<e.length;l++){var s=$("<li>"+e[l].title+"</li>");s.click(this.showMenu.bind(this,l)),s.mouseover(this.showMenu.bind(this,l)),n.append(s)}t.append(n);for(l=0;l<e.length;l++){for(var i=$('<ul class="menu"></ul>'),o=0;o<e[l].menuItems.length;o++){if("hr"==e[l].menuItems[o].title)var c=$('<li class="menu_hr"></li>');else(c=$('<li class="menu_item">'+e[l].menuItems[o].title+'<span class="shortcut">'+e[l].menuItems[o].shortcut+"</span></li>")).click(e[l].menuItems[o].handler);i.append(c)}i.css("width",e[l].width),i.css("left",62*l),t.append(i),this.$menus.push(i)}return this.$menubar=t},this.showMenu=function(e,t){if(t.stopPropagation(),"click"==t.type&&-1<this.openMenu)this.hideMenu();else if("click"==t.type||-1<this.openMenu){this.openMenu=e;for(var n=0;n<this.$menus.length;n++)n==e?this.$menus[n].addClass("active"):this.$menus[n].removeClass("active")}},this.hideMenu=function(){this.openMenu=-1;for(var e=0;e<this.$menus.length;e++)this.$menus[e].removeClass("active")}}$notepad.append($menubar);